---
import type { CollectionEntry } from "astro:content";
import DateMeta from "@/components/DateMeta.astro";

interface Props {
    post: CollectionEntry<"blog">;
}

const { post } = Astro.props;

const bodySlice = (body: string | undefined) => {
    if (!body) return "";
    if (body.includes("<!--more-->")) {
        return body.split('<!--more-->')[0];
    }
    if (body.includes("<!-- more -->")) {
        return body.split('<!-- more -->')[0];
    }
    return body.slice(0, 200) + (body.length > 200 ? "(...)" : "");
};
---

<section class="post-entry w-full">
    <a href={`/archives/${post.id}`} class="text-2xl font-bold">
        {post.data.title}
    </a>

    <div class="entry-meta my-1">
        <DateMeta post={post} />
    </div>

    <div>
        {post.data.description ? post.data.description : bodySlice(post.body)}
    </div>
</section>

<style lang="scss">
    .post-entry {
        background-color: md-color("surface-container-lowest", "light");
        border: 0.2rem solid md-color("surface-container-highest", "light");
        border-radius: 0.1875rem;
        box-shadow: 0.2rem 0.25rem md-color("surface-container", "light");

        @apply p-6;
    }

    .entry-meta {
        color: md-color("secondary", "light");
    }
</style>